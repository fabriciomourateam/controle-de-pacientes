<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Comparativo de EvoluÃ§Ã£o</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1e293b;
            color: #e2e8f0;
        }
        .test-case {
            background-color: #334155;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .result {
            background-color: #0f172a;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
        }
        .comparison-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid #475569;
        }
        .positive { color: #10b981; }
        .negative { color: #ef4444; }
        .neutral { color: #64748b; }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Teste - Comparativo de EvoluÃ§Ã£o de Check-ins</h1>
    
    <div class="grid">
        <div class="test-case">
            <h3>ğŸ“Š Check-in Atual</h3>
            <div class="result">
                <div class="comparison-item">
                    <span>âš–ï¸ Peso:</span>
                    <span>75.5kg</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ“ Cintura:</span>
                    <span>63cm</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ“ Quadril:</span>
                    <span>97cm</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸƒ Treinos:</span>
                    <span>5</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸƒâ€â™‚ï¸ Cardio:</span>
                    <span>3</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ’§ Ãgua:</span>
                    <span>2.5L</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ˜´ Sono:</span>
                    <span>7.5h</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ½ï¸ RefeiÃ§Ãµes Livres:</span>
                    <span>2</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸª Beliscos:</span>
                    <span>1</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ“ˆ Aproveitamento:</span>
                    <span>85%</span>
                </div>
            </div>
        </div>

        <div class="test-case">
            <h3>ğŸ“Š Check-in Anterior</h3>
            <div class="result">
                <div class="comparison-item">
                    <span>âš–ï¸ Peso:</span>
                    <span>76.2kg</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ“ Cintura:</span>
                    <span>65cm</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ“ Quadril:</span>
                    <span>99cm</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸƒ Treinos:</span>
                    <span>3</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸƒâ€â™‚ï¸ Cardio:</span>
                    <span>2</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ’§ Ãgua:</span>
                    <span>2.0L</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ˜´ Sono:</span>
                    <span>6.5h</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ½ï¸ RefeiÃ§Ãµes Livres:</span>
                    <span>3</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸª Beliscos:</span>
                    <span>4</span>
                </div>
                <div class="comparison-item">
                    <span>ğŸ“ˆ Aproveitamento:</span>
                    <span>78%</span>
                </div>
            </div>
        </div>
    </div>

    <div class="test-case">
        <h3>ğŸ“ˆ EvoluÃ§Ã£o Comparativa (SimulaÃ§Ã£o)</h3>
        <div class="result" id="evolution-result">
            <!-- SerÃ¡ preenchido pelo JavaScript -->
        </div>
    </div>

    <script>
        // Simular funÃ§Ã£o cleanNumber
        function cleanNumber(value) {
            if (!value) return 0;
            const str = value.toString().replace(/[^\d.,]/g, '');
            const normalized = str.replace(',', '.');
            const num = parseFloat(normalized);
            return isNaN(num) ? 0 : num;
        }

        // Dados simulados
        const currentCheckin = {
            peso: '75.5',
            medida: 'cintura: 63 quadril: 97',
            treino: '5',
            cardio: '3',
            agua: '2.5',
            sono: '7.5',
            ref_livre: '2',
            beliscos: '1',
            percentual_aproveitamento: '85'
        };

        const previousCheckin = {
            peso: '76.2',
            medida: 'cintura: 65 quadril: 99',
            treino: '3',
            cardio: '2',
            agua: '2.0',
            sono: '6.5',
            ref_livre: '3',
            beliscos: '4',
            percentual_aproveitamento: '78'
        };

        // Simular extraÃ§Ã£o de medidas
        function extractMeasurements(text) {
            if (!text) return { cintura: null, quadril: null };
            
            const cinturaMatch = text.match(/cintura[^:]*:\s*(\d+(?:\.\d+)?)/i);
            const quadrilMatch = text.match(/quadril[^:]*:\s*(\d+(?:\.\d+)?)/i);
            
            return {
                cintura: cinturaMatch ? parseFloat(cinturaMatch[1]) : null,
                quadril: quadrilMatch ? parseFloat(quadrilMatch[1]) : null
            };
        }

        // Calcular evoluÃ§Ã£o
        function calculateEvolution() {
            const pesoAtual = cleanNumber(currentCheckin.peso);
            const pesoAnterior = cleanNumber(previousCheckin.peso);
            
            const medidasAtuais = extractMeasurements(currentCheckin.medida);
            const medidasAnteriores = extractMeasurements(previousCheckin.medida);

            const evolution = {
                peso_diferenca: pesoAtual && pesoAnterior ? 
                    Number((pesoAtual - pesoAnterior).toFixed(1)) : 0,
                cintura_diferenca: medidasAtuais.cintura && medidasAnteriores.cintura ? 
                    Number((medidasAtuais.cintura - medidasAnteriores.cintura).toFixed(1)) : 0,
                quadril_diferenca: medidasAtuais.quadril && medidasAnteriores.quadril ? 
                    Number((medidasAtuais.quadril - medidasAnteriores.quadril).toFixed(1)) : 0,
                treino_diferenca: (() => {
                    const treinoAtual = cleanNumber(currentCheckin.treino);
                    const treinoAnterior = cleanNumber(previousCheckin.treino);
                    return treinoAtual && treinoAnterior ? Number((treinoAtual - treinoAnterior).toFixed(1)) : 0;
                })(),
                cardio_diferenca: (() => {
                    const cardioAtual = cleanNumber(currentCheckin.cardio);
                    const cardioAnterior = cleanNumber(previousCheckin.cardio);
                    return cardioAtual && cardioAnterior ? Number((cardioAtual - cardioAnterior).toFixed(1)) : 0;
                })(),
                agua_diferenca: (() => {
                    const aguaAtual = cleanNumber(currentCheckin.agua);
                    const aguaAnterior = cleanNumber(previousCheckin.agua);
                    return aguaAtual && aguaAnterior ? Number((aguaAtual - aguaAnterior).toFixed(1)) : 0;
                })(),
                sono_diferenca: (() => {
                    const sonoAtual = cleanNumber(currentCheckin.sono);
                    const sonoAnterior = cleanNumber(previousCheckin.sono);
                    return sonoAtual && sonoAnterior ? Number((sonoAtual - sonoAnterior).toFixed(1)) : 0;
                })(),
                ref_livre_diferenca: (() => {
                    const refLivreAtual = cleanNumber(currentCheckin.ref_livre);
                    const refLivreAnterior = cleanNumber(previousCheckin.ref_livre);
                    return refLivreAtual && refLivreAnterior ? Number((refLivreAtual - refLivreAnterior).toFixed(1)) : 0;
                })(),
                beliscos_diferenca: (() => {
                    const beliscosAtual = cleanNumber(currentCheckin.beliscos);
                    const beliscosAnterior = cleanNumber(previousCheckin.beliscos);
                    return beliscosAtual && beliscosAnterior ? Number((beliscosAtual - beliscosAnterior).toFixed(1)) : 0;
                })(),
                aderencia_diferenca: (() => {
                    const aproveitamentoAtual = Number(currentCheckin.percentual_aproveitamento) || 0;
                    const aproveitamentoAnterior = Number(previousCheckin.percentual_aproveitamento) || 0;
                    return aproveitamentoAtual && aproveitamentoAnterior ? 
                        Number((aproveitamentoAtual - aproveitamentoAnterior).toFixed(1)) : 0;
                })()
            };

            return evolution;
        }

        // Renderizar resultado
        function renderEvolution() {
            const evolution = calculateEvolution();
            const resultDiv = document.getElementById('evolution-result');
            
            const items = [
                { label: 'âš–ï¸ Peso:', value: evolution.peso_diferenca, unit: 'kg', good: 'negative' },
                { label: 'ğŸ“ Cintura:', value: evolution.cintura_diferenca, unit: 'cm', good: 'negative' },
                { label: 'ğŸ“ Quadril:', value: evolution.quadril_diferenca, unit: 'cm', good: 'negative' },
                { label: 'ğŸƒ Treinos:', value: evolution.treino_diferenca, unit: '', good: 'positive' },
                { label: 'ğŸƒâ€â™‚ï¸ Cardio:', value: evolution.cardio_diferenca, unit: '', good: 'positive' },
                { label: 'ğŸ’§ Ãgua:', value: evolution.agua_diferenca, unit: 'L', good: 'positive' },
                { label: 'ğŸ˜´ Sono:', value: evolution.sono_diferenca, unit: 'h', good: 'positive' },
                { label: 'ğŸ½ï¸ RefeiÃ§Ãµes Livres:', value: evolution.ref_livre_diferenca, unit: '', good: 'negative' },
                { label: 'ğŸª Beliscos:', value: evolution.beliscos_diferenca, unit: '', good: 'negative' },
                { label: 'ğŸ“ˆ Aproveitamento:', value: evolution.aderencia_diferenca, unit: '%', good: 'positive' }
            ];

            let html = '';
            items.forEach(item => {
                // Mostrar TODOS os campos, mesmo os que sÃ£o 0
                const isGood = (item.good === 'positive' && item.value > 0) || 
                              (item.good === 'negative' && item.value < 0);
                const colorClass = item.value === 0 ? 'neutral' : (isGood ? 'positive' : 'negative');
                const sign = item.value > 0 ? '+' : '';
                
                html += `
                    <div class="comparison-item">
                        <span>${item.label}</span>
                        <span class="${colorClass}">${sign}${item.value}${item.unit}</span>
                    </div>
                `;
            });

            if (!html) {
                html = '<div class="comparison-item"><span>Nenhuma diferenÃ§a significativa encontrada</span></div>';
            }

            resultDiv.innerHTML = html;
        }

        // Executar quando a pÃ¡gina carregar
        document.addEventListener('DOMContentLoaded', renderEvolution);
    </script>
</body>
</html>